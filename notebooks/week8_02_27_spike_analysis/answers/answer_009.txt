# Answer

for i, r in df_files.iterrows():
    print("Processing:", i, r['filepath'])

    spike_times = get_spike_times(r['filepath'])
    
    inter_spike_intervals = np.diff(spike_times)
    num_spike_events = len(spike_times)
    
    if num_spike_events > 0:
        spike_frequency = num_spike_events / np.sum(inter_spike_intervals)
    else:
        spike_frequency = np.nan
    
    onset_time = 1
    time_to_last_spike = spike_times.max() if num_spike_events > 0 else None

    df_files.loc[i,'spike_count']=num_spike_events
    df_files.loc[i,'spike_frequency']=spike_frequency
    df_files.loc[i,'time_to_last_spike']=time_to_last_spike
